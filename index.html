<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–ú º–Ø–°–¢–û–†–Ü–Ø ‚Ä¢ –ü–æ–¥–∞—Ä—É–Ω–∫–æ–≤—ñ –∫–∞—Ä—Ç–∫–∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-gradient: radial-gradient(circle at top, #fff7ed 0, #f3e4d4 35%, #e1c6ad 70%, #2c1810 100%);
      --panel-bg: rgba(255, 255, 255, 0.92);
      --panel-border: rgba(255, 255, 255, 0.8);
      --panel-shadow: 0 18px 45px rgba(0, 0, 0, 0.35);

      --my-red: #d62828;
      --my-red-dark: #7b1515;
      --my-cream: #f6f1ea;
      --my-muted: #7a6b60;
      --my-text: #221711;
      --my-gold: #c79b4b;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      min-height: 100vh;
      background: var(--bg-gradient);
      color: var(--my-text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px 12px;
    }

    .app {
      width: 100%;
      max-width: 1120px;
      border-radius: 28px;
      background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04));
      border: 1px solid rgba(255,255,255,0.3);
      box-shadow: var(--panel-shadow);
      overflow: hidden;
      backdrop-filter: blur(14px);
    }

    /* HEADER */

    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      padding: 10px 18px;
      background: rgba(0,0,0,0.92);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand-logo {
      width: 130px;
      max-width: 36vw;
    }

    .brand-logo img {
      width: 100%;
      height: auto;
      display: block;
    }

    .brand-caption {
      font-size: 11px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgba(249, 245, 235, 0.8);
    }

    .debug-toggle {
      border-radius: 999px;
      border: 1px dashed rgba(255,255,255,0.5);
      padding: 4px 10px;
      font-size: 10px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      color: #f9fafb;
      background: rgba(0,0,0,0.4);
    }

    .debug-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34,197,94,0.9);
    }

    .debug-toggle.off .debug-dot {
      background: #9ca3af;
      box-shadow: none;
    }

    .debug-toggle.off {
      opacity: 0.75;
    }

    @media (max-width: 640px) {
      .top-bar {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    /* MAIN LAYOUT */

    .main {
      display: grid;
      grid-template-columns: minmax(0, 1.25fr) minmax(0, 1fr);
      gap: 22px;
      padding: 22px 22px 20px;
    }

    @media (max-width: 900px) {
      .main {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      border-radius: 20px;
      background: var(--panel-bg);
      border: 1px solid var(--panel-border);
      box-shadow: 0 10px 30px rgba(0,0,0,0.16);
      padding: 18px 18px 16px;
    }

    /* LEFT INFO PANEL */

    .tagline {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(214,40,40,0.06);
      border: 1px solid rgba(214,40,40,0.25);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--my-red);
      margin-bottom: 10px;
    }

    .tagline-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--my-red);
    }

    h1 {
      margin: 0 0 8px;
      font-size: clamp(22px, 3vw, 28px);
      line-height: 1.15;
      color: #311a11;
    }

    .subtitle {
      font-size: 14px;
      color: var(--my-muted);
      line-height: 1.6;
      margin: 0 0 14px;
      max-width: 480px;
    }

    .info-list {
      list-style: none;
      padding: 0;
      margin: 0 0 14px;
      font-size: 13px;
    }

    .info-list li {
      display: flex;
      gap: 8px;
      margin-bottom: 6px;
      color: #4b3527;
    }

    .info-bullet {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      border: 2px solid var(--my-red);
      margin-top: 5px;
    }

    .prob-box {
      margin-top: 6px;
      padding: 10px 12px;
      border-radius: 14px;
      background: #f7eee3;
      border: 1px dashed rgba(0,0,0,0.1);
      font-size: 12px;
      color: var(--my-muted);
    }

    .prob-row {
      margin-top: 3px;
    }

    .prob-row strong {
      color: #312016;
    }

    .status {
      margin-top: 10px;
      font-size: 12px;
      color: var(--my-muted);
    }

    .status strong {
      color: var(--my-red-dark);
    }

    .result-box {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: #111827;
      color: #e5e7eb;
      font-size: 12px;
    }

    .result-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    .result-main {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .result-desc {
      font-size: 12px;
      color: #e5e7eb;
    }

    /* RIGHT GRID PANEL */

    .grid-header {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--my-muted);
      margin-bottom: 10px;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(80px, 1fr));
      gap: 10px;
    }

    @media (max-width: 480px) {
      .card-grid {
        gap: 8px;
      }
    }

    .card {
      position: relative;
      padding-top: 100%; /* –∫–≤–∞–¥—Ä–∞—Ç */
      perspective: 900px;
      cursor: pointer;
    }

    .card-inner {
      position: absolute;
      inset: 0;
      border-radius: 16px;
      transform-style: preserve-3d;
      transition: transform 0.6s cubic-bezier(0.22, 0.77, 0.3, 1.02);
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }

    .card-front,
    .card-back {
      position: absolute;
      inset: 0;
      border-radius: 16px;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .card-front {
      background:
        radial-gradient(circle at 30% 20%, #ffffff 0, #f7ece3 36%, #f0d0bd 70%, #e1b49b 100%);
      border: 2px solid #fff7ec;
      box-shadow:
        inset 0 0 0 1px rgba(0,0,0,0.06),
        0 10px 20px rgba(0,0,0,0.3);
      color: #3a2014;
      flex-direction: column;
      gap: 6px;
      font-size: 11px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      font-weight: 700;
    }

    .card-front span {
      font-size: 9px;
      opacity: 0.8;
    }

    .card-front-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      border: 2px solid rgba(0,0,0,0.25);
    }

    .card-back {
      transform: rotateY(180deg);
      background:
        radial-gradient(circle at 30% 20%, #fff7e6 0, #f7d59a 45%, #f0b25c 100%);
      border: 2px solid #fef9e6;
      box-shadow:
        inset 0 0 0 1px rgba(0,0,0,0.1),
        0 10px 22px rgba(0,0,0,0.35);
      padding: 10px;
      flex-direction: column;
      gap: 6px;
      color: #2b1604;
    }

    .card-prize-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      opacity: 0.85;
    }

    .card-prize-main {
      font-size: 20px;
      font-weight: 800;
      letter-spacing: 0.22em;
      text-transform: uppercase;
    }

    .card-prize-desc {
      font-size: 11px;
      line-height: 1.5;
    }

    .card-open .card-inner {
      transform: rotateY(180deg);
    }

    .card-disabled {
      cursor: default;
      opacity: 0.55;
    }

    .grid-footer {
      margin-top: 10px;
      font-size: 11px;
      color: var(--my-muted);
    }

    /* TOAST */

    .toast {
      position: fixed;
      left: 50%;
      bottom: 16px;
      transform: translateX(-50%) translateY(120%);
      background: #111827;
      color: #f9fafb;
      padding: 8px 14px;
      border-radius: 999px;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 14px 32px rgba(0,0,0,0.7);
      opacity: 0;
      transition: transform 0.25s ease-out, opacity 0.25s ease-out;
      z-index: 1000;
    }

    .toast.visible {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    .toast-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
    }

    .toast.error .toast-dot {
      background: #ef4444;
    }

    /* FIREWORKS */

    .fireworks-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 900;
    }

    .firework-dot {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: #fff;
      opacity: 0;
      animation: fireworks 1200ms ease-out forwards;
    }

    @keyframes fireworks {
      0% {
        transform: translate(0,0) scale(0.4);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      70% {
        opacity: 1;
      }
      100% {
        transform: translate(var(--dx), var(--dy)) scale(0.2);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="top-bar">
      <div class="brand">
        <div class="brand-logo">
          <img src="https://myastoriya.com.ua/frontend/myastoriya/dist/images/logo.png" alt="–ú º–Ø–°–¢–û–†–Ü–Ø">
        </div>
        <div class="brand-caption">–æ–Ω–ª–∞–π–Ω-—Ä–æ–∑—ñ–≥—Ä–∞—à –¥–ª—è –≥–æ—Å—Ç–µ–π</div>
      </div>

      <button id="debugToggle" class="debug-toggle">
        <span class="debug-dot"></span>
        DEBUG: unlimited
      </button>
    </header>

    <main class="main">
      <!-- LEFT PANEL -->
      <section class="panel">
        <div class="tagline">
          <span class="tagline-dot"></span>
          –ø–æ–¥–∞—Ä—É–Ω–∫–æ–≤—ñ –∫–∞—Ä—Ç–∫–∏ ¬´–º º—è—Å—Ç–æ—Ä—ñ—è¬ª
        </div>

        <h1>–û–±–µ—Ä–∏ –æ–¥–Ω—É –∑&nbsp;9 –∫–∞—Ä—Ç–æ–∫ —Ç–∞ –≤—ñ–¥–∫—Ä–∏–π —Å–≤—ñ–π –º º—è—Å–Ω–∏–π –±–æ–Ω—É—Å</h1>
        <p class="subtitle">
          –ù–∞ –µ–∫—Ä–∞–Ω—ñ ‚Äî –¥–µ–≤ º—è—Ç—å –∑–∞–∫—Ä–∏—Ç–∏—Ö –∫–∞—Ä—Ç–æ–∫. –û–±–µ—Ä–∏ –±—É–¥—å-—è–∫—É, –Ω–∞—Ç–∏—Å–Ω–∏ ‚Äî —ñ –¥—ñ–∑–Ω–∞–π—Å—è,
          —è–∫—É –∑–Ω–∏–∂–∫—É –æ—Ç—Ä–∏–º–∞—î—à –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ ¬´–ú º–Ø–°–¢–û–†–Ü–Ø¬ª.
        </p>

        <ul class="info-list">
          <li>
            <div class="info-bullet"></div>
            <div>–£ —Ä–µ–∞–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –ª–∏—à–µ <strong>–æ–¥–Ω—É –∫–∞—Ä—Ç–∫—É –Ω–∞ –¥–µ–Ω—å</strong> –∑ —Ü—å–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é.</div>
          </li>
          <li>
            <div class="info-bullet"></div>
            <div>–ü—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–∏ –ø–æ–∫–∞–∂–µ–º–æ —Ç–≤—ñ–π –ø—Ä–∏–∑ —ñ –ø—ñ–¥–∫–∞–∂–µ–º–æ, —è–∫ –Ω–∏–º —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è.</div>
          </li>
        </ul>

        <div class="prob-box">
          <div><strong>–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏–∑–∏:</strong></div>
          <div class="prob-row">‚Ä¢ –ö—É–ø–æ–Ω –Ω–∞ –∑–Ω–∏–∂–∫—É –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.</div>
          <div class="prob-row">‚Ä¢ –ó–Ω–∏–∂–∫–∞ <strong>-20%</strong> –Ω–∞ –≤–µ—Å—å —á–µ–∫.</div>
          <div class="prob-row">‚Ä¢ –ó–Ω–∏–∂–∫–∞ <strong>-30%</strong> –Ω–∞ –≤–µ—Å—å —á–µ–∫.</div>
          <div class="prob-row">‚Ä¢ <strong>–ì–æ–ª–æ–≤–Ω–∏–π –ø—Ä–∏–∑</strong> ‚Äî –∑–Ω–∏–∂–∫–∞ <strong>-60%</strong> –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.</div>
          <div class="prob-row" style="margin-top:6px;">
            <em>–ô–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –≥–æ–ª–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–∑—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–ª–∏–∑—å–∫–æ <strong>1%</strong>.</em>
          </div>
        </div>

        <div id="statusText" class="status">
          –°—å–æ–≥–æ–¥–Ω—ñ —Ç–∏ —â–µ <strong>–Ω–µ</strong> –≤—ñ–¥–∫—Ä–∏–≤–∞–≤ –∫–∞—Ä—Ç–∫—É. –û–±–∏—Ä–∞–π ‚Äî —É–¥–∞—á—ñ! ü•©
        </div>

        <div class="result-box">
          <div class="result-title">–í–∞—à —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—ñ–π –ø—Ä–∏–∑</div>
          <div id="resultMain" class="result-main">–©–µ –Ω–µ –æ–±—Ä–∞–Ω–æ –∫–∞—Ä—Ç–∫—É</div>
          <div id="resultDesc" class="result-desc">
            –ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –æ–¥–Ω—É –∑ –∫–∞—Ä—Ç–æ–∫ –ø—Ä–∞–≤–æ—Ä—É—á, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Å–≤—ñ–π –±–æ–Ω—É—Å.
          </div>
        </div>
      </section>

      <!-- RIGHT PANEL -->
      <section class="panel">
        <div class="grid-header">–ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –æ–¥–Ω—É –∫–∞—Ä—Ç–∫—É, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ —ó—ó</div>
        <div id="cardGrid" class="card-grid">
          <!-- 9 cards -->
          <!-- —à–∞–±–ª–æ–Ω –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è; –∫–æ–∂–Ω–∞ –º–∞—î data-index -->
          <div class="card" data-index="0">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="1">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="2">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="3">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="4">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="5">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="6">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="7">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>

          <div class="card" data-index="8">
            <div class="card-inner">
              <div class="card-front">
                <div class="card-front-dot"></div>
                –í–ò–ë–†–ê–¢–ò
                <span>–∫–∞—Ä—Ç–∫—É</span>
              </div>
              <div class="card-back">
                <div class="card-prize-label">–í–∞—à –ø—Ä–∏–∑</div>
                <div class="card-prize-main">???</div>
                <div class="card-prize-desc"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="grid-footer">
          –ü—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –∫–∞—Ä—Ç–∫–∏ —ñ–Ω—à—ñ –∑–∞–ª–∏—à–∞—Ç—å—Å—è –∑–∞–∫—Ä–∏—Ç–∏–º–∏ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –¥–Ω—è
          (–≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Ä–µ–∂–∏–º—ñ; —É DEBUG ‚Äî –±–µ–∑ –æ–±–º–µ–∂–µ–Ω—å).
        </div>
      </section>
    </main>
  </div>

  <div id="toast" class="toast">
    <span class="toast-dot"></span>
    <span id="toastText"></span>
  </div>

  <div id="fireworksLayer" class="fireworks-layer"></div>

  <script>
    // ---------- CONFIG ----------
    let DEBUG_MODE = true; // –ö–æ–ª–∏ –±—É–¥–µ—à –∑–∞–ø—É—Å–∫–∞—Ç–∏ –¥–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ ‚Äî –ø–æ—Å—Ç–∞–≤ false

    const DATE_KEY = "myastoriya_cards_date";
    const PRIZE_KEY = "myastoriya_cards_prize";

    const PRIZES = {
      coupon: {
        label: "–ö–£–ü–û–ù",
        desc: "–ö—É–ø–æ–Ω –Ω–∞ –∑–Ω–∏–∂–∫—É –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –î–µ—Ç–∞–ª—ñ —Ç–∞ —É–º–æ–≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ‚Äî –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∞–∫—Ü—ñ–π ¬´–ú º–Ø–°–¢–û–†–Ü–Ø¬ª."
      },
      d20: {
        label: "-20%",
        desc: "–ó–Ω–∏–∂–∫–∞ 20% –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –í–≤–µ–¥–∏ –ø—Ä–æ–º–æ–∫–æ–¥ –∞–±–æ –≤–∏–∫–æ–Ω–∞–π —É–º–æ–≤–∏ –∞–∫—Ü—ñ—ó –Ω–∞ —Å–∞–π—Ç—ñ."
      },
      d30: {
        label: "-30%",
        desc: "–©–µ–¥—Ä–∞ –∑–Ω–∏–∂–∫–∞ 30% –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –ß—É–¥–æ–≤–∏–π –ø—Ä–∏–≤—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π —Å—Ç–µ–π–∫."
      },
      d60: {
        label: "-60%",
        desc: "–ì–û–õ–û–í–ù–ò–ô –ü–†–ò–ó! 60% –∑–Ω–∏–∂–∫–∏ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –ó–±–µ—Ä–µ–∂–∏ —Ü–µ–π –µ–∫—Ä–∞–Ω ‚Äî –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ –ø–æ–ø—Ä–æ—Å–∏—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤–∏–≥—Ä–∞—à—É."
      }
    };

    // –í–∞–≥–∏ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π: 70% –∫—É–ø–æ–Ω, 20% -20, 9% -30, 1% -60
    const WEIGHTS = [
      { type: "coupon", weight: 70 },
      { type: "d20", weight: 20 },
      { type: "d30", weight: 9 },
      { type: "d60", weight: 1 }
    ];

    function weightedRandom() {
      const total = WEIGHTS.reduce((s, w) => s + w.weight, 0);
      const r = Math.random() * total;
      let acc = 0;
      for (const w of WEIGHTS) {
        acc += w.weight;
        if (r <= acc) return w.type;
      }
      return WEIGHTS[0].type;
    }

    function todayKey() {
      return new Date().toISOString().slice(0, 10);
    }

    function hasPlayedToday() {
      if (DEBUG_MODE) return false;
      try {
        return localStorage.getItem(DATE_KEY) === todayKey();
      } catch (e) {
        return false;
      }
    }

    function lockToday(prizeType) {
      try {
        localStorage.setItem(DATE_KEY, todayKey());
        localStorage.setItem(PRIZE_KEY, prizeType);
      } catch (e) {}
    }

    function getStoredPrize() {
      try {
        return localStorage.getItem(PRIZE_KEY);
      } catch (e) {
        return null;
      }
    }

    // ---------- UI ELEMENTS ----------
    const cards = Array.from(document.querySelectorAll(".card"));
    const statusEl = document.getElementById("statusText");
    const resultMainEl = document.getElementById("resultMain");
    const resultDescEl = document.getElementById("resultDesc");
    const toastEl = document.getElementById("toast");
    const toastTextEl = document.getElementById("toastText");
    const fireworksLayer = document.getElementById("fireworksLayer");
    const debugToggle = document.getElementById("debugToggle");

    // ---------- HELPERS ----------
    function updateStatus() {
      if (DEBUG_MODE) {
        statusEl.innerHTML =
          'DEBUG —Ä–µ–∂–∏–º: –æ–±–º–µ–∂–µ–Ω–Ω—è <strong>–≤–∏–º–∫–Ω–µ–Ω–æ</strong>, –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –∫–∞—Ä—Ç–∫–∏ —Å–∫—ñ–ª—å–∫–∏ –∑–∞–≤–≥–æ–¥–Ω–æ.';
        return;
      }
      if (hasPlayedToday()) {
        const storedPrize = getStoredPrize();
        if (storedPrize && PRIZES[storedPrize]) {
          const p = PRIZES[storedPrize];
          statusEl.innerHTML =
            "–°—å–æ–≥–æ–¥–Ω—ñ –∫–∞—Ä—Ç–∫—É –≤–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞–ª–∏. –¢–≤—ñ–π –ø—Ä–∏–∑: <strong>" +
            p.label +
            "</strong> ‚Äî " +
            p.desc;
        } else {
          statusEl.innerHTML =
            "–°—å–æ–≥–æ–¥–Ω—ñ –∫–∞—Ä—Ç–∫—É –≤–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞–ª–∏. –ü–æ–≤–µ—Ä–Ω–∏—Å—å –∑–∞–≤—Ç—Ä–∞, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑.";
        }
      } else {
        statusEl.innerHTML =
          "–°—å–æ–≥–æ–¥–Ω—ñ —Ç–∏ —â–µ <strong>–Ω–µ</strong> –≤—ñ–¥–∫—Ä–∏–≤–∞–≤ –∫–∞—Ä—Ç–∫—É. –û–±–∏—Ä–∞–π ‚Äî —É–¥–∞—á—ñ! ü•©";
      }
    }

    function setResult(prizeType) {
      if (!prizeType || !PRIZES[prizeType]) {
        resultMainEl.textContent = "–©–µ –Ω–µ –æ–±—Ä–∞–Ω–æ –∫–∞—Ä—Ç–∫—É";
        resultDescEl.textContent = "–ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –æ–¥–Ω—É –∑ –∫–∞—Ä—Ç–æ–∫ –ø—Ä–∞–≤–æ—Ä—É—á, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Å–≤—ñ–π –±–æ–Ω—É—Å.";
        return;
      }
      const p = PRIZES[prizeType];
      resultMainEl.textContent = p.label;
      resultDescEl.textContent = p.desc;
    }

    function showToast(message, isError) {
      toastTextEl.textContent = message;
      toastEl.classList.toggle("error", !!isError);
      toastEl.classList.add("visible");
      setTimeout(() => {
        toastEl.classList.remove("visible");
      }, 2600);
    }

    function triggerFireworks() {
      if (!fireworksLayer) return;
      const bursts = 3;
      for (let b = 0; b < bursts; b++) {
        const cx = window.innerWidth * (0.3 + 0.4 * Math.random());
        const cy = window.innerHeight * (0.25 + 0.35 * Math.random());
        const count = 16 + Math.floor(Math.random() * 8);
        const radius = 80 + Math.random() * 60;

        for (let i = 0; i < count; i++) {
          const angle = (Math.PI * 2 * i) / count;
          const dx = Math.cos(angle) * radius;
          const dy = Math.sin(angle) * radius;

          const dot = document.createElement("div");
          dot.className = "firework-dot";
          dot.style.left = cx + "px";
          dot.style.top = cy + "px";
          dot.style.setProperty("--dx", dx + "px");
          dot.style.setProperty("--dy", dy + "px";

          const color =
            i % 3 === 0 ? "#f97316" : i % 3 === 1 ? "#facc15" : "#ef4444";
          dot.style.background = color;
          dot.style.boxShadow = "0 0 12px " + color;

          fireworksLayer.appendChild(dot);
          dot.addEventListener("animationend", () => dot.remove());
        }
      }
    }

    function disableAllCards() {
      cards.forEach(card => card.classList.add("card-disabled"));
    }

    function enableAllCards() {
      cards.forEach(card => card.classList.remove("card-disabled"));
    }

    function applyPrizeToCard(card, prizeType) {
      const cfg = PRIZES[prizeType];
      if (!cfg) return;
      const mainEl = card.querySelector(".card-prize-main");
      const descEl = card.querySelector(".card-prize-desc");
      if (mainEl) mainEl.textContent = cfg.label;
      if (descEl) descEl.textContent = cfg.desc;
    }

    // ---------- CARD CLICK ----------
    function onCardClick(e) {
      const card = e.currentTarget;
      if (card.classList.contains("card-open")) return;

      if (!DEBUG_MODE && hasPlayedToday()) {
        showToast("–°—å–æ–≥–æ–¥–Ω—ñ –∫–∞—Ä—Ç–∫—É –≤–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞–ª–∏ –∑ —Ü—å–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é.", true);
        disableAllCards();
        updateStatus();
        return;
      }

      const prizeType = weightedRandom();

      applyPrizeToCard(card, prizeType);
      card.classList.add("card-open");
      setResult(prizeType);

      if (!DEBUG_MODE) {
        lockToday(prizeType);
        disableAllCards();
      }

      updateStatus();

      if (prizeType === "d60") {
        triggerFireworks();
        showToast("–ì–æ–ª–æ–≤–Ω–∏–π –ø—Ä–∏–∑! -60% –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è üéâ", false);
      } else {
        showToast("–ì–æ—Ç–æ–≤–æ! –î–∏–≤–∏—Å—å, —â–æ –≤–∏–ø–∞–ª–æ –Ω–∞ —Ç–≤–æ—ó–π –∫–∞—Ä—Ç—Ü—ñ.", false);
      }
    }

    cards.forEach(card => card.addEventListener("click", onCardClick));

    // ---------- DEBUG TOGGLE ----------
    function refreshDebugToggle() {
      if (!debugToggle) return;
      if (DEBUG_MODE) {
        debugToggle.classList.remove("off");
        debugToggle.innerHTML = '<span class="debug-dot"></span>DEBUG: unlimited';
        enableAllCards();
      } else {
        debugToggle.classList.add("off");
        debugToggle.innerHTML = '<span class="debug-dot"></span>DEBUG: daily limit';
        if (hasPlayedToday()) disableAllCards();
      }
    }

    debugToggle.addEventListener("click", () => {
      DEBUG_MODE = !DEBUG_MODE;
      refreshDebugToggle();
      updateStatus();
      showToast(
        DEBUG_MODE
          ? "DEBUG —É–≤—ñ–º–∫–Ω–µ–Ω–æ: –æ–±–º–µ–∂–µ–Ω–Ω—è –≤–∏–º–∫–Ω–µ–Ω–æ."
          : "DEBUG –≤–∏–º–∫–Ω–µ–Ω–æ: –¥—ñ—î 1 –∫–∞—Ä—Ç–∫–∞ –Ω–∞ –¥–µ–Ω—å.",
        false
      );
    });

    // ---------- INIT ----------
    (function init() {
      refreshDebugToggle();
      updateStatus();

      if (!DEBUG_MODE && hasPlayedToday()) {
        const storedPrize = getStoredPrize();
        if (storedPrize && PRIZES[storedPrize]) {
          setResult(storedPrize);
        }
        disableAllCards();
      } else {
        setResult(null);
      }
    })();
  </script>
</body>
</html>
